#PowerShell commands to run scripts on many different clips. Blender path and script folders need to be changed to whatever you use

#This exports all bone keyframe data to a CSV file, and then uses it in a second script
gci .\*.blend | % { ."C:\Program Files\Blender Foundation\Blender 3.6\blender.exe" -b $_.FullName --python "G:\Modding\PC\Sims 4 Mods\Blender Scripts\export_to_csv.py" }
gci .\Adult\*.blend | % { ."C:\Program Files\Blender Foundation\Blender 3.6\blender.exe" -b $_.FullName --python "G:\Modding\PC\Sims 4 Mods\Blender Scripts\fix_from_csv_root_nofeetclip.py" }

#
gci .\*.blend | % { ."C:\Program Files\Blender Foundation\Blender 3.6\blender.exe" -b $_.FullName --python "G:\Modding\PC\Sims 4 Mods\Blender Scripts\generic_pose_fixer.py" }

#Rename clips by prepending a string, useful when a clip with that name already exists in game
gci *.blend | % { Rename-Item -LiteralPath $_.FullName -NewName ("adult_" + $_.Name) }
gci *.blend | % { Rename-Item -LiteralPath $_.FullName -NewName ("child_" + $_.Name) }

#Rename clips by replacing a portion, can reduce or eliminate need to modify ASMs. Also useful for renaming .csvs generated by the first example at the top
gci p2o_*.blend | % { Rename-Item -LiteralPath $_.FullName -NewName ($_.Name -replace "p2o_","c2o_") }
gci p2o_*.blend | % { Rename-Item -LiteralPath $_.FullName -NewName ($_.Name -replace "p2o_","a2o_") }

gci "M:\Sims 4 Infant Clip Exports\Adult\*.blend" | % { ."C:\Program Files\Blender Foundation\Blender 3.6\blender.exe" -b $_.FullName --python "G:\Modding\PC\Sims 4 Mods\Blender Scripts\generic_pose_fixer.py" }
gci "M:\Sims 4 Infant Clip Exports\Child\*.blend" | % { ."C:\Program Files\Blender Foundation\Blender 3.6\blender.exe" -b $_.FullName --python "G:\Modding\PC\Sims 4 Mods\Blender Scripts\generic_pose_fixer.py" }
gci "M:\Sims 4 Toddler Clip Exports\Adult\*.blend" | % { ."C:\Program Files\Blender Foundation\Blender 3.6\blender.exe" -b $_.FullName --python "G:\Modding\PC\Sims 4 Mods\Blender Scripts\generic_pose_fixer.py" }
gci "M:\Sims 4 Toddler Clip Exports\Child\*.blend" | % { ."C:\Program Files\Blender Foundation\Blender 3.6\blender.exe" -b $_.FullName --python "G:\Modding\PC\Sims 4 Mods\Blender Scripts\generic_pose_fixer.py" }